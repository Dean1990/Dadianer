{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "com",
    "require",
    "module",
    "exports",
    "chuPai",
    "player",
    "getWindNum",
    "_currentPlayer",
    "_lastPai",
    "isPlayerParty",
    "nextPlayer",
    "sortPai",
    "shouPai",
    "isEnableXuanZhan",
    "checkEnableXuanZhan",
    "isXuanZhan",
    "actionLabel",
    "string",
    "length",
    "firstChuPai",
    "pais",
    "getEnableChuPai",
    "message",
    "pNum",
    "weightArr",
    "analyze",
    "splice",
    "lastWeight",
    "convertValueMore",
    "i",
    "weight",
    "lastPlayerNum",
    "sortWeightArr",
    "j",
    "tempArr",
    "Array",
    "f",
    "_name",
    "substring",
    "l",
    "parseInt",
    "push",
    "convertClownValue",
    "f2",
    "slice",
    "convertValue",
    "isCompose",
    "l2"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "var com = require('Common');\nmodule.exports = {\n\n    chuPai: function (player,getWindNum){\n\n        //有人要风\n        if(getWindNum!=-1){\n\n            if(getWindNum==com._currentPlayer){\n\n                com._lastPai = null;\n\n            }else if(com.isPlayerParty(com._currentPlayer,getWindNum)){\n                //队友  不出\n                com.nextPlayer(null,\"给风\",getWindNum);\n\n                return;\n                \n            }\n\n        }\n\n        com.sortPai(player.shouPai)\n\n        var isEnableXuanZhan = com.checkEnableXuanZhan();\n\n        if(isEnableXuanZhan!=0){\n            //可以宣战\n            //设置宣战\n            player.isXuanZhan = true;\n\n            //宣战 修改全局变量\n            com.isXuanZhan = true;\n\n            if(isEnableXuanZhan==1){\n\n                player.actionLabel.string = \"宣战\";\n\n            }else if(isEnableXuanZhan==2){\n\n                player.actionLabel.string = \"跟\";\n\n            }\n            \n        }\n\n        if(com._lastPai==null||com._lastPai.length==0){\n\n            this.firstChuPai(player);\n\n        }else {\n\n            var pais = this.getEnableChuPai(player);\n\n            var message = null;\n\n            var pNum = -1;\n\n            if(pais!=null && pais.length>0){\n                //有人要风\n                if(getWindNum!=-1){\n\n                    message = \"不给\";\n                }\n                \n            }else{\n            \n                message = \"给风\";\n\n                pNum = getWindNum;\n\n            }\n\n            com.nextPlayer(pais,message,pNum);\n\n            \n        }\n\n    },\n\n    /**\n     * 第一个出牌\n     */\n    firstChuPai:function(player){\n\n        var weightArr = this.analyze(player.shouPai);\n\n        //出一个最小权值的组合\n        if(weightArr.length>0){\n\n            var pais = player.shouPai.splice(weightArr[0][1],weightArr[0][2]);\n\n            com.nextPlayer(pais);\n\n        }\n\n    },\n\n    /**\n     * 计算出可以出的牌\n     */\n    getEnableChuPai:function(player){\n\n            var weightArr = this.analyze(player.shouPai);\n\n            var lastWeight = com.convertValueMore(com._lastPai);\n\n            //要出的牌\n            var pais = null;\n\n            for(var i = 0;i<weightArr.length;i++){\n\n                var weight = weightArr[i][0];\n\n                if(weight>lastWeight && (((com._lastPai.length==1 && (weight<=180 || weight>1600))||com._lastPai.length>1))){\n\n                    //上一张牌是否是队友出的\n                    if(com.isPlayerParty(com._currentPlayer,com.lastPlayerNum) && ((com._lastPai.length==1 && weight>140) || (com._lastPai.length>1 && weight>1400))){\n                        //不怼队友\n                        //大于A或者大于对A 不出\n                    }else {\n\n                        //出牌\n                        pais = player.shouPai.splice(weightArr[i][1],weightArr[i][2]);\n\n                    }\n\n                    break;\n\n                }\n\n            }\n\n            return pais;\n\n    },\n\n    /**\n     * 出牌动作\n     */\n    // chuPaiAction:function(pais){\n\n    //     var size = cc.winSize;\n\n    //     // //清空lastPai\n    //     // if(com._lastPai!=null){\n    //     //     //清空上家出的牌 准备记录此次出牌\n    //     //     com._lastPai.splice(0,com._lastPai.length);\n\n    //     // }else {\n\n    //     //     com._lastPai = new Array();\n\n    //     // }\n\n    //     //展示\n    //     for(var j = 0;j<pais.length;j++){\n\n    //         var node = pais[j];\n\n    //         cc.director.getScene().addChild(node);\n\n    //         node.setPosition(cc.p(size.width/2 + j*30,size.height/2));\n\n    //         //更新到lastPai\n    //         // com._lastPai.push(pais[j]);\n\n    //     }\n\n    // },\n\n    /**\n     * 排序权值列表\n     */\n    sortWeightArr:function(weightArr){\n\n        for(var i = 0;i<weightArr.length;i++){\n\n            for(var j = i;j<weightArr.length;j++){\n\n                if(weightArr[i][0]>weightArr[j][0]){\n\n                    var tempArr = weightArr[i];\n\n                    weightArr[i] = weightArr[j];\n\n                    weightArr[j] = tempArr;\n\n                }\n\n            }\n\n        }\n\n    },\n\n    /**\n     * 计算可以出牌的所有权值\n     */\n    analyze:function(pais){\n\n        var weightArr = new Array();//[权值,开始下标,长度]\n\n        // var lastLength = com._lastPai.length;\n\n        if(pais!=null){\n\n            // for(var j = 0;j<pais.length;j++){\n            //     cc.log(pais[j]._name);\n            // }\n                \n\n            for(var i = 0;i<pais.length;i++){\n\n                // cc.log(\"i:\"+i);\n                // cc.log(weightArr.length);\n                // cc.log(pais[i]._name);\n\n                var f = pais[i]._name.substring(0,1);\n\n                var l = parseInt(pais[i]._name.substring(1));\n\n                if(f == \"E\"){\n                    // if(lastLength==1){\n                        //鬼 单张\n                        weightArr.push([com.convertClownValue(l),i,1]);\n                    // }\n\n                    var j = i+1;\n\n                    if(j<pais.length){\n\n                        var f2 = pais[j]._name.substring(0,1);\n                        if(f2 == \"E\"){\n                            //存储对鬼的权值\n                            weightArr.push([com.convertValueMore(pais.slice(i,j+1)),i,2]);\n\n                        }\n\n                    }\n\n                }else {\n                    // if(lastLength==1){\n                        //对单张的权值保存\n                        weightArr.push([com.convertValue(l),i,1]);\n                    // }\n\n                    var j = 0;\n\n                    var isCompose = false;\n\n                    do{\n                        j++;\n\n                        if((i+j)<pais.length){\n                        \n                            var l2 = parseInt(pais[i+j]._name.substring(1));\n\n                            isCompose = l==l2;\n\n                            // var isDifferentFive = false;\n                            // //对花5的处理\n                            // if(l==5 && j==1){\n\n                            //     var f2 = pais[i+j]._name.substring(0,1);\n\n                            //     var code = f.charCodeAt()+f2.charCodeAt();\n\n                            //     //不是对黑5红5\n                            //     if(code!=196 && code!=198){\n\n                            //         isDifferentFive = true;\n\n                            //     }\n\n                            // }\n\n                            // if(isCompose && (!(lastLength==1 && j==1) || (l==5 && !isDifferentFive))){\n                            if(isCompose){\n\n                                //对多张的权值保存\n                                weightArr.push([com.convertValueMore(pais.slice(i,i+j+1)),i,j+1]);\n                                \n                            }\n\n                        }else{\n\n                            break;\n\n                        }\n\n                    }while(isCompose);\n\n                    if(l!=5){\n                        //5特殊不能省略这个过程\n                        //去除重复权值计算\n                        i = i+j-1;\n                    }\n\n                }\n\n            }\n\n        }\n\n        this.sortWeightArr(weightArr);\n\n        return weightArr;\n\n    },\n\n\n    \n\n};\n"
  ]
}