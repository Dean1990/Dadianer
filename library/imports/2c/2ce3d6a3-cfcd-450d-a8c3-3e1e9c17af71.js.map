{"version":3,"sources":["../../../../assets/script/assets/script/Common.js"],"names":["module","exports","lang","Object","playerNum","paiNum","rounds","players","_lastPai","_currentPlayer","lastPlayerNum","winPlayer","partyPlayers","isXuanZhan","num","getWindPlayerNum","setFirstPlayer","firstPlayer","currentTag","setVisible","checkNextPlayerNoWinner","length","indexOf","nextPlayer","lastPai","message","clearRecordPlayerPai","actionLabel","string","clearPaiZhuo","showLastPai","isPlayerWin","shouPai","push","party","isGameOver","isPlayerParty","cc","director","getScene","getChildByName","getComponent","gameLabel","toggle","checkChuPai","xuanPai","p","isCurrent","composeCheck","lastLength","convertValueMore","value","arr","_name","substring","isClown","i","value2","convertValue","l","convertClownValue","weight","f","parseInt","Math","pow","charCodeAt","sortPai","spriteArr","j","name1","name2","temp","code1","code2","size","winSize","node","addChild","setPosition","width","height","node1","instantiate","labelBottomNode","setScale","setAnchorPoint","setCascadeOpacityEnabled","removeFromParent","destroy","removeAllChildren","checkEnableXuanZhan","pNum","pNum2"],"mappings":"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","file":"Common.js","sourceRoot":"../../../../assets/script","sourcesContent":["module.exports = {\n\n    lang:Object,\n\n    playerNum : 4,//玩家数\n\n    paiNum : 32,//牌数\n\n    rounds:0,//回合数\n\n    players: null,//所有玩家的容器\n\n    _lastPai:null,//上家出的牌\n\n    //_firstPlayer:0,//第一个出牌的玩家\n\n    _currentPlayer:0,//当前出牌的玩家\n\n    //_buChuNum:0,//记录不出牌次数\n\n    lastPlayerNum:0,//最后出牌的玩家\n\n    winPlayer:null,//记录胜出者序号\n\n    partyPlayers:null,//记录同一伙可宣战的玩家数组\n\n    isXuanZhan:false,//是否宣战\n\n    num:0,//记数\n\n    getWindPlayerNum:-1,//记录给风的记数\n\n    //voteGetWindNum:0,//参于投票人数\n\n    setFirstPlayer:function(firstPlayer){\n\n        this._currentPlayer = firstPlayer;\n\n        this.players[this._currentPlayer].currentTag.setVisible(true);\n\n    },\n\n    /**\n     * 检查玩家，剔除胜出者，继续游戏\n     */\n    checkNextPlayerNoWinner:function(){\n\n        this.num = this.num +1;\n\n        //控制递归深度\n        if(this.winPlayer.length<this.playerNum){\n\n            if(this.num%this.playerNum==0){\n\n                this.rounds = this.rounds + 1;\n\n            }\n\n\n            this._currentPlayer = (this._currentPlayer+1) % this.playerNum;\n\n            if(this.winPlayer.indexOf(this._currentPlayer)!=-1){\n\n                this.checkNextPlayerNoWinner();\n\n            }\n\n        }\n        // cc.log(\"chekc player index:\"+this._currentPlayer);\n\n    },\n\n    /**\n     * 下一个玩家\n     */\n    nextPlayer:function(lastPai,message){\n\n            //设置默认值\n            // getWindNum = getWindNum||-1;\n\n            //清理当前玩家记录牌\n            this.clearRecordPlayerPai();\n\n            //当前调用该函数的玩家部分\n            if(lastPai==null||lastPai.length==0){\n\n                // this._buChuNum = this._buChuNum + 1;\n                //不出\n                if(message==null){\n\n                    message = \"不出\";\n\n                }\n\n                if(this.getWindPlayerNum!=-1){\n                    //给风\n                    message = \"给风\";\n\n                }\n\n                this.players[this._currentPlayer].actionLabel.string = message;\n\n            }else {\n                //清除要风记录\n                this.getWindPlayerNum = -1;\n\n                // this._buChuNum = 0;\n                this.lastPlayerNum = this._currentPlayer;\n                //清理牌桌\n                this.clearPaiZhuo();\n\n                //赋值\n                this._lastPai = lastPai;\n                //展示\n                this.showLastPai();\n\n            }\n\n            this.players[this._currentPlayer].currentTag.setVisible(false);\n\n            var isPlayerWin = this.players[this._currentPlayer].shouPai.length == 0 && this.winPlayer.indexOf(this._currentPlayer)==-1;\n\n            if(isPlayerWin){\n\n                //cc.log(\"wp lenght:\"+this.winPlayer.length);\n\n                this.winPlayer.push(this._currentPlayer);\n\n                //this.players[this._currentPlayer].shouPaiNum.string = \"\";\n\n                this.players[this._currentPlayer].actionLabel.string = \"NO. \"+this.winPlayer.length;\n\n                var party = this.partyPlayers.indexOf(this._currentPlayer)!=-1;\n\n                var isGameOver = false;\n\n                if(this.partyPlayers.length == 1){\n                    //1:3\n                    \n                    if(party){\n                        //双鬼胜\n                        isGameOver = true;\n\n                    }else if(this.winPlayer.length==3){\n                        //没鬼玩家胜\n                        isGameOver = this.winPlayer.indexOf(this.partyPlayers[0])==-1;\n\n                    }\n\n                }else {\n                    //2:2\n\n                    if(this.winPlayer.length==2){\n\n                        isGameOver = this.isPlayerParty(this.winPlayer[0],this.winPlayer[1]);\n\n                    }else if(this.winPlayer.length==3){\n\n                        isGameOver = true;\n\n                    }\n\n                }\n\n                if(isGameOver){\n\n                    //清理牌桌\n                    this.clearPaiZhuo();\n\n                    cc.director.getScene().getChildByName('Canvas').getComponent('Game').gameLabel.string = \"游戏结束\";\n\n                    return;\n\n                }\n\n            }\n\n            \n\n            //********** 当前调用该函数的玩家部分结束 ************\n\n            \n            //下一个玩家部分\n            //下一个合法的出牌者\n            //this._currentPlayer = (this._currentPlayer+1)%this.playerNum;\n            this.checkNextPlayerNoWinner();\n\n            //cc.log(this.players[this._currentPlayer]);\n    \n            this.players[this._currentPlayer].currentTag.setVisible(true);\n\n            this.players[this._currentPlayer].actionLabel.string = \"\";\n\n\n            //三个不出，说明又轮到上次出牌的玩家 当有胜出者后，判断的数字要减少\n            // if(this._buChuNum==(3-this.winPlayer.length)){\n            \n            if(this.lastPlayerNum==this._currentPlayer){\n\n                //清理牌桌\n                this.clearPaiZhuo();\n\n                this._lastPai = null;\n\n            }\n\n            \n\n            if(isPlayerWin){\n\n                //记录下一个出牌者，及要风者\n                this.getWindPlayerNum = this._currentPlayer;\n\n                \n                // getWindNum = this._currentPlayer;\n\n                //更新下一个出牌者+1 出找下下家要风\n                this.checkNextPlayerNoWinner();\n\n            }\n\n            //通知玩家可以出牌了\n            this.players[this._currentPlayer].toggle();\n\n        \n\n    },\n        \n    /**\n     * 检查出牌的合法性\n     */\n    checkChuPai:function(xuanPai,p){\n\n        var isCurrent = p==this._currentPlayer;\n\n        // isCurrent = true;\n\n        //是否该出牌\n        if(!isCurrent){\n\n            return false;\n        }\n\n        //判断选中的牌\n        if(xuanPai!=null){\n\n            if((this.getWindPlayerNum==p) || this._lastPai==null || this._lastPai.length==0){\n\n                this.clearPaiZhuo();\n\n                return this.composeCheck(xuanPai);\n\n            }else {\n\n                var length = xuanPai.length;\n\n                var lastLength = this._lastPai.length;\n\n                if(lastLength==1){\n                    //单\n                    if(length == 1){\n\n                        return this.convertValueMore(xuanPai)>this.convertValueMore(this._lastPai);\n\n                    }else {\n                        //炸 大于1600为炸\n                        var value = this.convertValueMore(xuanPai);\n\n                        return value>1600 && value>this.convertValueMore(this._lastPai);\n\n                    }\n\n                }else if(lastLength >= 2 && lastLength < 5){\n                    //对\n                    if(length>=2){\n                        //可以出对，也可以出炸\n                        return this.convertValueMore(xuanPai)>this.convertValueMore(this._lastPai);\n\n                    }else {\n                        //不能出单\n                        return false;\n\n                    }\n\n                }\n\n                return false;\n\n            }\n\n        }\n\n        return false;\n\n    },\n\n    /**\n     * 组合检查\n     */\n    composeCheck:function(arr){\n\n        var length = arr.length;\n\n        if(length==1){\n\n            return true;\n        }else if(length<5){\n\n            var value = arr[0]._name.substring(1);\n\n            var isClown = false;\n\n            for(var i = 0;i<length;i++){\n                //鬼是一个特殊的组合\n                if(arr[i]._name.substring(0,1)==\"E\"){\n\n                    if(isClown){\n\n                        //只有两张 且都是鬼\n                        if(length ==2 ){\n\n                            return true;\n\n                        }else {\n\n                            return false;\n\n                        }\n                    }else {\n\n                        isClown = true;\n\n                    }\n                        \n\n                }else {\n                    //进到这里，这张牌不是大小鬼，出现不同权值 返回false\n                    if(isClown){\n\n                        return false;\n\n                    }\n\n                    var value2 = arr[i]._name.substring(1);\n\n                    if(value!=value2){\n\n                        return false;\n\n                    }\n\n                }\n\n            }\n\n            //如果到这里 isClown 为真，及有鬼存在，但多张牌只有一个鬼，说明牌组合不对\n            return !isClown;\n\n        }else {\n\n            return false;\n\n        }\n\n    },\n\n    /**\n     * 权值转换 \n     * 不包括大小鬼\n     */\n    convertValue:function(l){\n\n        if(l<4){\n\n            return (13+l)*10;\n\n        }else {\n\n            return l*10;\n\n        }\n\n    },\n\n    /**\n     * 大小鬼权值转换 \n     * \n     */\n    convertClownValue:function(l){\n        //大鬼 l = 0  小鬼 l=1\n        //小鬼要大于最大的单\n        return (13+3+2-l)*10;\n\n    },\n\n    /**\n     * 权值转换 多张\n     */\n    convertValueMore:function(arr){\n\n        var weight = 0;\n\n        if(arr==null || arr.length == 0 || !this.composeCheck(arr)){\n\n            return weight;\n\n        }else {\n\n            var f = arr[0]._name.substring(0,1);\n\n            var l = parseInt(arr[0]._name.substring(1));\n\n            if(f == \"E\"){\n                //鬼\n                weight = 13+3+2-l;\n                \n\n            }else {\n\n                if(l<4){\n\n                    weight = 13+l;\n\n                }else {\n\n                    weight = l;\n\n                }\n\n            }\n            //特例\n            if(arr.length==2){\n\n                if(l == 10){\n\n                    return 16*Math.pow(10,2)+1;//比对3大1\n\n                }else if(l == 5){\n\n                    var value = f.charCodeAt()+arr[1]._name.substring(0,1).charCodeAt();\n                                    \n                    if(value == 196){\n                        //对黑5\n                        return 16*Math.pow(10,4)+3;//比对红5大1\n                    }else if(value == 198){\n                        //对红5\n                        return 16*Math.pow(10,4)+2//比对鬼大1\n                    }\n                    \n                }else if(f == \"E\"){\n\n                    return 16*Math.pow(10,4)+1;//比四个3大1\n\n                }\n\n            }\n\n            //cc.log(\"weight:\"+weight);\n\n            return weight * Math.pow(10,arr.length);\n\n\n        }\n\n    },\n\n    /**\n     * 排序方法\n     */\n    sortPai:function(spriteArr){\n\n        //cc.log(spriteArr);\n\n        for(var i = 0;i<spriteArr.length;i++){\n\n            for(var j = i+1;j<spriteArr.length;j++){\n\n                var name1 = spriteArr[i]._name;\n\n                var name2 = spriteArr[j]._name;\n\n                //cc.log(name1.substring(1));\n\n                //cc.log(\"name1:\"+name1+\" name2:\"+name2);\n              \n                if(parseInt(name1.substring(1))>parseInt(name2.substring(1))){\n\n                    //cc.log(\"-name1:\"+name1+\" name2:\"+name2);\n\n                    var temp = spriteArr[i];\n\n                    spriteArr[i] = spriteArr[j];\n\n                    spriteArr[j] = temp;\n\n                }else if(name1.substring(1)==name2.substring(1)){\n\n                    var code1 = name1.substring(0,1).charCodeAt();\n                    var code2 = name2.substring(0,1).charCodeAt();\n\n                    //5的特殊排序\n                    if(name1.substring(1)==\"5\"){\n                        //把对黑5或对红5放到一起\n                        //把红桃与草花互换\n                        if(code1==99){\n\n                            code1 = 98;\n\n                        }else if(code1==98){\n\n                            code1 = 99;\n\n                        }\n\n                        if(code2==99){\n\n                            code2 = 98;\n\n                        }else if(code2==98){\n\n                            code2 = 99;\n\n                        }\n\n                    }\n\n                    if(code1>code2){\n\n                        var temp = spriteArr[i];\n\n                        spriteArr[i] = spriteArr[j];\n\n                        spriteArr[j] = temp;\n\n                    }\n\n                }\n            }\n            \n\n        }\n\n    },\n\n    /**\n     * 展示在牌桌上\n     */\n    showLastPai:function(){\n\n        // cc.log(\"player:\"+this._currentPlayer);\n\n        if(this._lastPai!=null && this._lastPai.length !=0){\n\n            var size = cc.winSize;\n\n            //展示\n            for(var j = 0;j<this._lastPai.length;j++){\n\n                var node = this._lastPai[j];\n\n                // cc.log(\"node:\");\n                // cc.log(node);\n\n                cc.director.getScene().addChild(node);\n\n                node.setPosition(cc.p(size.width/2 + j*30,size.height/2));\n\n                //node.runAction(cc.rotateBy(0,this._currentPlayer*-90));\n\n                // var node1 = cc.instantiate(node._prefab.asset);\n\n                //记录每回合出牌画在头像下边\n                if(this._currentPlayer!=0){\n\n                    var node1 = cc.instantiate(node);\n\n                    var labelBottomNode = this.players[this._currentPlayer].node.getChildByName('LabelBottom');\n\n                    labelBottomNode.addChild(node1);\n\n                    // this.players[this._currentPlayer].node.addChild(node1);\n\n                    node1.setScale(0.3,0.3);\n\n                    node1.setAnchorPoint(0,0);\n\n                    node1.setCascadeOpacityEnabled(false);\n\n                    node1.setPosition(cc.p(-labelBottomNode.width/2 + j*10,-labelBottomNode.height/2-node1.height/3));\n\n\n                }\n\n            }\n\n        }\n\n    },\n\n    /**\n     * 清空牌桌\n     */\n    clearPaiZhuo:function(){\n\n        // cc.log(\"clearPaiZhuo\");\n\n        if(this._lastPai!=null && this._lastPai.length !=0){\n\n            for(var i = 0;i<this._lastPai.length;i++){\n\n                var node = this._lastPai[i];\n\n                // cc.log(node);\n\n                node.removeFromParent();\n\n                node.destroy();\n\n            }\n\n        }\n\n    },\n\n    /**\n     * 清空记录在玩家头向下的出牌记录\n     */\n    clearRecordPlayerPai:function(){\n\n        var labelBottomNode = this.players[this._currentPlayer].node.getChildByName('LabelBottom');\n\n        labelBottomNode.removeAllChildren();\n\n    },\n\n    /**\n     * 是否可以宣战或跟随\n     * 不可以 0\n     * 宣战 1\n     * 跟随 2\n     */\n    checkEnableXuanZhan:function(pNum){\n\n        if(pNum==null){\n\n            pNum = this._currentPlayer;\n\n        }\n\n        // cc.log(\"rounds:\"+this.rounds);\n        // cc.log(this.partyPlayers);\n        // cc.log(pNum);\n        // cc.log(this.partyPlayers.indexOf(pNum)!=-1);\n\n        if(this.num<=4 && this.partyPlayers.indexOf(pNum)!=-1){\n\n            if(this.isXuanZhan){\n                //跟\n                return 2;\n            }else {\n                //宣战\n                return 1;\n\n            }\n\n        }else{\n\n            return 0;\n        }\n    },\n\n    /**\n     * 是否是同伙\n     */\n    isPlayerParty:function(pNum,pNum2){\n\n        return (pNum != pNum2) && !((this.partyPlayers.indexOf(pNum)==-1)^(this.partyPlayers.indexOf(pNum2)==-1));\n\n    },\n\n\n};\n"]}