{"version":3,"sources":["Common.js"],"names":["module","exports","lang","Object","playerNum","paiNum","rounds","players","_lastPai","_currentPlayer","lastPlayerNum","winPlayer","partyPlayers","isXuanZhan","num","getWindPlayerNum","setFirstPlayer","firstPlayer","currentTag","setVisible","checkNextPlayerNoWinner","length","indexOf","nextPlayer","lastPai","message","clearRecordPlayerPai","passTag","allow","actionLabel","string","clearPaiZhuo","showLastPai","isPlayerWin","shouPai","push","party","isGameOver","isPlayerParty","cc","director","getScene","getChildByName","getComponent","gameLabel","gameOver","toggle","checkChuPai","xuanPai","p","isCurrent","composeCheck","lastLength","convertValueMore","value","arr","_name","substring","isClown","i","value2","convertValue","l","convertClownValue","weight","f","parseInt","Math","pow","charCodeAt","sortPai","spriteArr","j","name1","name2","temp","code1","code2","size","winSize","node","addChild","setPosition","width","height","node1","instantiate","labelBottomNode","setScale","setAnchorPoint","setCascadeOpacityEnabled","removeFromParent","destroy","removeAllChildren","checkEnableXuanZhan","pNum","pNum2"],"mappings":"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","file":"Common.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["module.exports = {\r\n\r\n    lang:Object,\r\n\r\n    playerNum : 4,//玩家数\r\n\r\n    paiNum : 32,//牌数\r\n\r\n    rounds:0,//回合数\r\n\r\n    players: null,//所有玩家的容器\r\n\r\n    _lastPai:null,//上家出的牌\r\n\r\n    //_firstPlayer:0,//第一个出牌的玩家\r\n\r\n    _currentPlayer:0,//当前出牌的玩家\r\n\r\n    //_buChuNum:0,//记录不出牌次数\r\n\r\n    lastPlayerNum:0,//最后出牌的玩家\r\n\r\n    winPlayer:null,//记录胜出者序号\r\n\r\n    partyPlayers:null,//记录同一伙可宣战的玩家数组\r\n\r\n    isXuanZhan:false,//是否宣战\r\n\r\n    num:0,//记数\r\n\r\n    getWindPlayerNum:-1,//记录给风的记数\r\n\r\n    //voteGetWindNum:0,//参于投票人数\r\n\r\n    setFirstPlayer:function(firstPlayer){\r\n\r\n        this._currentPlayer = firstPlayer;\r\n\r\n        this.players[this._currentPlayer].currentTag.setVisible(true);\r\n\r\n    },\r\n\r\n    /**\r\n     * 检查玩家，剔除胜出者，继续游戏\r\n     */\r\n    checkNextPlayerNoWinner:function(){\r\n\r\n        this.num = this.num +1;\r\n\r\n        //控制递归深度\r\n        if(this.winPlayer.length<this.playerNum){\r\n\r\n            if(this.num%this.playerNum==0){\r\n\r\n                this.rounds = this.rounds + 1;\r\n\r\n            }\r\n\r\n\r\n            this._currentPlayer = (this._currentPlayer+1) % this.playerNum;\r\n\r\n            if(this.winPlayer.indexOf(this._currentPlayer)!=-1){\r\n\r\n                this.checkNextPlayerNoWinner();\r\n\r\n            }\r\n\r\n        }\r\n        // cc.log(\"chekc player index:\"+this._currentPlayer);\r\n\r\n    },\r\n\r\n    /**\r\n     * 下一个玩家\r\n     */\r\n    nextPlayer:function(lastPai,message){\r\n\r\n            //设置默认值\r\n            // getWindNum = getWindNum||-1;\r\n\r\n            //清理当前玩家记录牌\r\n            this.clearRecordPlayerPai();\r\n\r\n            //当前调用该函数的玩家部分\r\n            if(lastPai==null||lastPai.length==0){\r\n\r\n                // this._buChuNum = this._buChuNum + 1;\r\n                //不出\r\n                if(message==null){\r\n\r\n                    message = this.lang.passTag;\r\n\r\n                }\r\n\r\n                if(this.getWindPlayerNum!=-1){\r\n                    //给风\r\n                    message = this.lang.allow;\r\n\r\n                }\r\n\r\n                this.players[this._currentPlayer].actionLabel.string = message;\r\n\r\n            }else {\r\n                //清除要风记录\r\n                this.getWindPlayerNum = -1;\r\n\r\n                // this._buChuNum = 0;\r\n                this.lastPlayerNum = this._currentPlayer;\r\n                //清理牌桌\r\n                this.clearPaiZhuo();\r\n\r\n                //赋值\r\n                this._lastPai = lastPai;\r\n                //展示\r\n                this.showLastPai();\r\n\r\n            }\r\n\r\n            this.players[this._currentPlayer].currentTag.setVisible(false);\r\n\r\n            var isPlayerWin = this.players[this._currentPlayer].shouPai.length == 0 && this.winPlayer.indexOf(this._currentPlayer)==-1;\r\n\r\n            if(isPlayerWin){\r\n\r\n                //cc.log(\"wp lenght:\"+this.winPlayer.length);\r\n\r\n                this.winPlayer.push(this._currentPlayer);\r\n\r\n                //this.players[this._currentPlayer].shouPaiNum.string = \"\";\r\n\r\n                this.players[this._currentPlayer].actionLabel.string = \"NO. \"+this.winPlayer.length;\r\n\r\n                var party = this.partyPlayers.indexOf(this._currentPlayer)!=-1;\r\n\r\n                var isGameOver = false;\r\n\r\n                if(this.partyPlayers.length == 1){\r\n                    //1:3\r\n                    \r\n                    if(party){\r\n                        //双鬼胜\r\n                        isGameOver = true;\r\n\r\n                    }else if(this.winPlayer.length==3){\r\n                        //没鬼玩家胜\r\n                        isGameOver = this.winPlayer.indexOf(this.partyPlayers[0])==-1;\r\n\r\n                    }\r\n\r\n                }else {\r\n                    //2:2\r\n\r\n                    if(this.winPlayer.length==2){\r\n\r\n                        isGameOver = this.isPlayerParty(this.winPlayer[0],this.winPlayer[1]);\r\n\r\n                    }else if(this.winPlayer.length==3){\r\n\r\n                        isGameOver = true;\r\n\r\n                    }\r\n\r\n                }\r\n\r\n                if(isGameOver){\r\n\r\n                    //清理牌桌\r\n                    this.clearPaiZhuo();\r\n\r\n                    cc.director.getScene().getChildByName('Canvas').getComponent('Game').gameLabel.string = this.lang.gameOver;\r\n\r\n                    return;\r\n\r\n                }\r\n\r\n            }\r\n\r\n            \r\n\r\n            //********** 当前调用该函数的玩家部分结束 ************\r\n\r\n            \r\n            //下一个玩家部分\r\n            //下一个合法的出牌者\r\n            //this._currentPlayer = (this._currentPlayer+1)%this.playerNum;\r\n            this.checkNextPlayerNoWinner();\r\n\r\n            //cc.log(this.players[this._currentPlayer]);\r\n    \r\n            this.players[this._currentPlayer].currentTag.setVisible(true);\r\n\r\n            this.players[this._currentPlayer].actionLabel.string = \"\";\r\n\r\n\r\n            //三个不出，说明又轮到上次出牌的玩家 当有胜出者后，判断的数字要减少\r\n            // if(this._buChuNum==(3-this.winPlayer.length)){\r\n            \r\n            if(this.lastPlayerNum==this._currentPlayer){\r\n\r\n                //清理牌桌\r\n                this.clearPaiZhuo();\r\n\r\n                this._lastPai = null;\r\n\r\n            }\r\n\r\n            \r\n\r\n            if(isPlayerWin){\r\n\r\n                //记录下一个出牌者，及要风者\r\n                this.getWindPlayerNum = this._currentPlayer;\r\n\r\n                \r\n                // getWindNum = this._currentPlayer;\r\n\r\n                //更新下一个出牌者+1 出找下下家要风\r\n                this.checkNextPlayerNoWinner();\r\n\r\n            }\r\n\r\n            //通知玩家可以出牌了\r\n            this.players[this._currentPlayer].toggle();\r\n\r\n        \r\n\r\n    },\r\n        \r\n    /**\r\n     * 检查出牌的合法性\r\n     */\r\n    checkChuPai:function(xuanPai,p){\r\n\r\n        var isCurrent = p==this._currentPlayer;\r\n\r\n        // isCurrent = true;\r\n\r\n        //是否该出牌\r\n        if(!isCurrent){\r\n\r\n            return false;\r\n        }\r\n\r\n        //判断选中的牌\r\n        if(xuanPai!=null){\r\n\r\n            if((this.getWindPlayerNum==p) || this._lastPai==null || this._lastPai.length==0){\r\n\r\n                this.clearPaiZhuo();\r\n\r\n                return this.composeCheck(xuanPai);\r\n\r\n            }else {\r\n\r\n                var length = xuanPai.length;\r\n\r\n                var lastLength = this._lastPai.length;\r\n\r\n                if(lastLength==1){\r\n                    //单\r\n                    if(length == 1){\r\n\r\n                        return this.convertValueMore(xuanPai)>this.convertValueMore(this._lastPai);\r\n\r\n                    }else {\r\n                        //炸 大于1600为炸\r\n                        var value = this.convertValueMore(xuanPai);\r\n\r\n                        return value>1600 && value>this.convertValueMore(this._lastPai);\r\n\r\n                    }\r\n\r\n                }else if(lastLength >= 2 && lastLength < 5){\r\n                    //对\r\n                    if(length>=2){\r\n                        //可以出对，也可以出炸\r\n                        return this.convertValueMore(xuanPai)>this.convertValueMore(this._lastPai);\r\n\r\n                    }else {\r\n                        //不能出单\r\n                        return false;\r\n\r\n                    }\r\n\r\n                }\r\n\r\n                return false;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return false;\r\n\r\n    },\r\n\r\n    /**\r\n     * 组合检查\r\n     */\r\n    composeCheck:function(arr){\r\n\r\n        var length = arr.length;\r\n\r\n        if(length==1){\r\n\r\n            return true;\r\n        }else if(length<5){\r\n\r\n            var value = arr[0]._name.substring(1);\r\n\r\n            var isClown = false;\r\n\r\n            for(var i = 0;i<length;i++){\r\n                //鬼是一个特殊的组合\r\n                if(arr[i]._name.substring(0,1)==\"E\"){\r\n\r\n                    if(isClown){\r\n\r\n                        //只有两张 且都是鬼\r\n                        if(length ==2 ){\r\n\r\n                            return true;\r\n\r\n                        }else {\r\n\r\n                            return false;\r\n\r\n                        }\r\n                    }else {\r\n\r\n                        isClown = true;\r\n\r\n                    }\r\n                        \r\n\r\n                }else {\r\n                    //进到这里，这张牌不是大小鬼，出现不同权值 返回false\r\n                    if(isClown){\r\n\r\n                        return false;\r\n\r\n                    }\r\n\r\n                    var value2 = arr[i]._name.substring(1);\r\n\r\n                    if(value!=value2){\r\n\r\n                        return false;\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n\r\n            //如果到这里 isClown 为真，及有鬼存在，但多张牌只有一个鬼，说明牌组合不对\r\n            return !isClown;\r\n\r\n        }else {\r\n\r\n            return false;\r\n\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * 权值转换 \r\n     * 不包括大小鬼\r\n     */\r\n    convertValue:function(l){\r\n\r\n        if(l<4){\r\n\r\n            return (13+l)*10;\r\n\r\n        }else {\r\n\r\n            return l*10;\r\n\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * 大小鬼权值转换 \r\n     * \r\n     */\r\n    convertClownValue:function(l){\r\n        //大鬼 l = 0  小鬼 l=1\r\n        //小鬼要大于最大的单\r\n        return (13+3+2-l)*10;\r\n\r\n    },\r\n\r\n    /**\r\n     * 权值转换 多张\r\n     */\r\n    convertValueMore:function(arr){\r\n\r\n        var weight = 0;\r\n\r\n        if(arr==null || arr.length == 0 || !this.composeCheck(arr)){\r\n\r\n            return weight;\r\n\r\n        }else {\r\n\r\n            var f = arr[0]._name.substring(0,1);\r\n\r\n            var l = parseInt(arr[0]._name.substring(1));\r\n\r\n            if(f == \"E\"){\r\n                //鬼\r\n                weight = 13+3+2-l;\r\n                \r\n\r\n            }else {\r\n\r\n                if(l<4){\r\n\r\n                    weight = 13+l;\r\n\r\n                }else {\r\n\r\n                    weight = l;\r\n\r\n                }\r\n\r\n            }\r\n            //特例\r\n            if(arr.length==2){\r\n\r\n                if(l == 10){\r\n\r\n                    return 16*Math.pow(10,2)+1;//比对3大1\r\n\r\n                }else if(l == 5){\r\n\r\n                    var value = f.charCodeAt()+arr[1]._name.substring(0,1).charCodeAt();\r\n                                    \r\n                    if(value == 196){\r\n                        //对黑5\r\n                        return 16*Math.pow(10,4)+3;//比对红5大1\r\n                    }else if(value == 198){\r\n                        //对红5\r\n                        return 16*Math.pow(10,4)+2//比对鬼大1\r\n                    }\r\n                    \r\n                }else if(f == \"E\"){\r\n\r\n                    return 16*Math.pow(10,4)+1;//比四个3大1\r\n\r\n                }\r\n\r\n            }\r\n\r\n            //cc.log(\"weight:\"+weight);\r\n\r\n            return weight * Math.pow(10,arr.length);\r\n\r\n\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * 排序方法\r\n     */\r\n    sortPai:function(spriteArr){\r\n\r\n        //cc.log(spriteArr);\r\n\r\n        for(var i = 0;i<spriteArr.length;i++){\r\n\r\n            for(var j = i+1;j<spriteArr.length;j++){\r\n\r\n                var name1 = spriteArr[i]._name;\r\n\r\n                var name2 = spriteArr[j]._name;\r\n\r\n                //cc.log(name1.substring(1));\r\n\r\n                //cc.log(\"name1:\"+name1+\" name2:\"+name2);\r\n              \r\n                if(parseInt(name1.substring(1))>parseInt(name2.substring(1))){\r\n\r\n                    //cc.log(\"-name1:\"+name1+\" name2:\"+name2);\r\n\r\n                    var temp = spriteArr[i];\r\n\r\n                    spriteArr[i] = spriteArr[j];\r\n\r\n                    spriteArr[j] = temp;\r\n\r\n                }else if(name1.substring(1)==name2.substring(1)){\r\n\r\n                    var code1 = name1.substring(0,1).charCodeAt();\r\n                    var code2 = name2.substring(0,1).charCodeAt();\r\n\r\n                    //5的特殊排序\r\n                    if(name1.substring(1)==\"5\"){\r\n                        //把对黑5或对红5放到一起\r\n                        //把红桃与草花互换\r\n                        if(code1==99){\r\n\r\n                            code1 = 98;\r\n\r\n                        }else if(code1==98){\r\n\r\n                            code1 = 99;\r\n\r\n                        }\r\n\r\n                        if(code2==99){\r\n\r\n                            code2 = 98;\r\n\r\n                        }else if(code2==98){\r\n\r\n                            code2 = 99;\r\n\r\n                        }\r\n\r\n                    }\r\n\r\n                    if(code1>code2){\r\n\r\n                        var temp = spriteArr[i];\r\n\r\n                        spriteArr[i] = spriteArr[j];\r\n\r\n                        spriteArr[j] = temp;\r\n\r\n                    }\r\n\r\n                }\r\n            }\r\n            \r\n\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * 展示在牌桌上\r\n     */\r\n    showLastPai:function(){\r\n\r\n        // cc.log(\"player:\"+this._currentPlayer);\r\n\r\n        if(this._lastPai!=null && this._lastPai.length !=0){\r\n\r\n            var size = cc.winSize;\r\n\r\n            //展示\r\n            for(var j = 0;j<this._lastPai.length;j++){\r\n\r\n                var node = this._lastPai[j];\r\n\r\n                // cc.log(\"node:\");\r\n                // cc.log(node);\r\n\r\n                cc.director.getScene().addChild(node);\r\n\r\n                node.setPosition(cc.p(size.width/2 + j*30,size.height/2));\r\n\r\n                //node.runAction(cc.rotateBy(0,this._currentPlayer*-90));\r\n\r\n                // var node1 = cc.instantiate(node._prefab.asset);\r\n\r\n                //记录每回合出牌画在头像下边\r\n                if(this._currentPlayer!=0){\r\n\r\n                    var node1 = cc.instantiate(node);\r\n\r\n                    var labelBottomNode = this.players[this._currentPlayer].node.getChildByName('LabelBottom');\r\n\r\n                    labelBottomNode.addChild(node1);\r\n\r\n                    // this.players[this._currentPlayer].node.addChild(node1);\r\n\r\n                    node1.setScale(0.3,0.3);\r\n\r\n                    node1.setAnchorPoint(0,0);\r\n\r\n                    node1.setCascadeOpacityEnabled(false);\r\n\r\n                    node1.setPosition(cc.p(-labelBottomNode.width/2 + j*10,-labelBottomNode.height/2-node1.height/3));\r\n\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * 清空牌桌\r\n     */\r\n    clearPaiZhuo:function(){\r\n\r\n        // cc.log(\"clearPaiZhuo\");\r\n\r\n        if(this._lastPai!=null && this._lastPai.length !=0){\r\n\r\n            for(var i = 0;i<this._lastPai.length;i++){\r\n\r\n                var node = this._lastPai[i];\r\n\r\n                // cc.log(node);\r\n\r\n                node.removeFromParent();\r\n\r\n                node.destroy();\r\n\r\n            }\r\n\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * 清空记录在玩家头向下的出牌记录\r\n     */\r\n    clearRecordPlayerPai:function(){\r\n\r\n        var labelBottomNode = this.players[this._currentPlayer].node.getChildByName('LabelBottom');\r\n\r\n        labelBottomNode.removeAllChildren();\r\n\r\n    },\r\n\r\n    /**\r\n     * 是否可以宣战或跟随\r\n     * 不可以 0\r\n     * 宣战 1\r\n     * 跟随 2\r\n     */\r\n    checkEnableXuanZhan:function(pNum){\r\n\r\n        if(pNum==null){\r\n\r\n            pNum = this._currentPlayer;\r\n\r\n        }\r\n\r\n        // cc.log(\"rounds:\"+this.rounds);\r\n        // cc.log(this.partyPlayers);\r\n        // cc.log(pNum);\r\n        // cc.log(this.partyPlayers.indexOf(pNum)!=-1);\r\n\r\n        if(this.num<=4 && this.partyPlayers.indexOf(pNum)!=-1){\r\n\r\n            if(this.isXuanZhan){\r\n                //跟\r\n                return 2;\r\n            }else {\r\n                //宣战\r\n                return 1;\r\n\r\n            }\r\n\r\n        }else{\r\n\r\n            return 0;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 是否是同伙\r\n     */\r\n    isPlayerParty:function(pNum,pNum2){\r\n\r\n        return (pNum != pNum2) && !((this.partyPlayers.indexOf(pNum)==-1)^(this.partyPlayers.indexOf(pNum2)==-1));\r\n\r\n    },\r\n\r\n\r\n};\r\n"]}